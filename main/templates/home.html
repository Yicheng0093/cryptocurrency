{% extends "base.html" %}

{% load static %}

{% block main %}
    {% load humanize %}
    
    <link rel="stylesheet" href="{% static 'css/home.css' %}">
    

    
    <h1>熱門加密貨幣</h1>

    <div class="button-container">
        <button onclick="showContent('info1')" class = "button">主流幣</button>
        <button onclick="showContent('info2')" class = "button">漲幅榜</button>
        <button onclick="showContent('info3')" class = "button">跌幅榜</button>
        <button onclick="showContent('info4')" class = "button">24h成交量</button>
    </div>
    
    <div class="card-coin mb-3" id="info1" style="max-width: 60%;">
        
        <div class="row g-0">
            {% if error %}
        <div class="alert alert-danger" role="alert">
            {{ error }}
        </div>
            {% else %}
            <table class="table table-bordered table-hover">
                {% include 'table_header.html' %}
                <tbody>
                    {% for price in top_coins %}
                        <tr>
                            <td style="text-align: center; vertical-align: middle;">
                                <a href="{% url 'crypto_detail' price.pk %}">
                                    <img src="{{ price.coin.logo_url }}" alt="logo"><br>{{ price.coin.coinname }}
                                </a>
                            </td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.usd|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.twd|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.jpy|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.eur|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.volume_24h|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">
                                {% if price.change_24h > 0 %}
                                    <span style="color: red;">{{ price.change_24h|floatformat:2 }}%</span>
                                {% elif price.change_24h < 0 %}
                                    <span style="color: green;">{{ price.change_24h|floatformat:2 }}%</span>
                                {% else %}
                                    <span style="color: black;">{{ price.change_24h|floatformat:2 }}%</span>
                                {% endif %}
                            </td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.timestamp }}</td>
                            
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% endif %}
        </div>
        <a data-testid="Web_NewHomePage_HotCrypto_More" href="{% url 'crypto_list' %}" class="sc-8bd51ba2-2 RBQIy" id = "a">探索更多</a>
    </div>

    <div class="card-coin mb-3" id="info2" style="max-width: 60%;">
        
        <div class="row g-0">
            {% if error %}
        <div class="alert alert-danger" role="alert">
            {{ error }}
        </div>
            {% else %}
            <table class="table table-bordered table-hover">
                {% include 'table_header.html' %}
                <tbody>
                    {% for price in increase_coins %}
                        <tr>
                            <td style="text-align: center; vertical-align: middle;">
                                <a href="{% url 'crypto_detail' price.pk %}">
                                    <img src="{{ price.coin.logo_url }}" alt="logo"><br>{{ price.coin.coinname }}
                                </a>
                            </td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.usd|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.twd|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.jpy|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.eur|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.volume_24h|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">
                                {% if price.change_24h > 0 %}
                                    <span style="color: red;">{{ price.change_24h|floatformat:2 }}%</span>
                                {% elif price.change_24h < 0 %}
                                    <span style="color: green;">{{ price.change_24h|floatformat:2 }}%</span>
                                {% else %}
                                    <span style="color: black;">{{ price.change_24h|floatformat:2 }}%</span>
                                {% endif %}
                            </td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.timestamp }}</td>
                            
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% endif %}
        </div>
        <a data-testid="Web_NewHomePage_HotCrypto_More" href="{% url 'crypto_list' %}" class="sc-8bd51ba2-2 RBQIy" id = "a">探索更多</a>
    </div>

    <div class="card-coin mb-3" id="info3" style="max-width: 60%;">
        
        <div class="row g-0">
            {% if error %}
        <div class="alert alert-danger" role="alert">
            {{ error }}
        </div>
            {% else %}
            <table class="table table-bordered table-hover">
                {% include 'table_header.html' %}
                <tbody>
                    {% for price in decline_coins %}
                        <tr>
                            <td style="text-align: center; vertical-align: middle;">
                                <a href="{% url 'crypto_detail' price.pk %}">
                                    <img src="{{ price.coin.logo_url }}" alt="logo"><br>{{ price.coin.coinname }}
                                </a>
                            </td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.usd|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.twd|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.jpy|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.eur|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.volume_24h|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">
                                {% if price.change_24h > 0 %}
                                    <span style="color: red;">{{ price.change_24h|floatformat:2 }}%</span>
                                {% elif price.change_24h < 0 %}
                                    <span style="color: green;">{{ price.change_24h|floatformat:2 }}%</span>
                                {% else %}
                                    <span style="color: black;">{{ price.change_24h|floatformat:2 }}%</span>
                                {% endif %}
                            </td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.timestamp }}</td>
                            
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% endif %}
        </div>
        <a data-testid="Web_NewHomePage_HotCrypto_More" href="{% url 'crypto_list' %}" class="sc-8bd51ba2-2 RBQIy" id = "a">探索更多</a>
    </div>

    <div class="card-coin mb-3" id="info4" style="max-width: 60%;">
        
        <div class="row g-0">
            {% if error %}
        <div class="alert alert-danger" role="alert">
            {{ error }}
        </div>
            {% else %}
            <table class="table table-bordered table-hover">
                {% include 'table_header.html' %}
                <tbody>
                    {% for price in volume %}
                        <tr>
                            <td style="text-align: center; vertical-align: middle;">
                                <a href="{% url 'crypto_detail' price.pk %}">
                                    <img src="{{ price.coin.logo_url }}" alt="logo"><br>{{ price.coin.coinname }}
                                </a>
                            </td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.usd|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.twd|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.jpy|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.eur|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.volume_24h|floatformat:2|intcomma }}</td>
                            <td style="text-align: center; vertical-align: middle;">
                                {% if price.change_24h > 0 %}
                                    <span style="color: red;">{{ price.change_24h|floatformat:2 }}%</span>
                                {% elif price.change_24h < 0 %}
                                    <span style="color: green;">{{ price.change_24h|floatformat:2 }}%</span>
                                {% else %}
                                    <span style="color: black;">{{ price.change_24h|floatformat:2 }}%</span>
                                {% endif %}
                            </td>
                            <td style="text-align: center; vertical-align: middle;">{{ price.timestamp }}</td>
                            
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% endif %}
        </div>
        <a data-testid="Web_NewHomePage_HotCrypto_More" href="{% url 'crypto_list' %}" class="sc-8bd51ba2-2 RBQIy" id = "a">探索更多</a>
    </div>

    <div class="carousel">
        <svg width="800" height="300">
            <defs>
                <!-- 定義線性漸變 -->
                <linearGradient id="pathGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" stop-color="#87CEFA" stop-opacity="1" />
                    <stop offset="100%" stop-color="#87CEFA" stop-opacity="0" />
                </linearGradient>
            </defs>
            <!-- 管道形狀 -->
            <path id="motionPath" 
                d="M 20 50 
                    H 300
                    A 150 150 0 0 1 450 200
                    V 700
                    "  
                  stroke="url(#pathGradient)" stroke-width="150" fill="none">
            </path>
    
            <!-- 球體 -->
            <circle id="ball" cx="150" cy="600" r="60" fill="#6495ed"></circle>
        </svg>
        <div class="card-head">
            <h2 style = "color: white;">歡迎來到虛擬貨幣分析平台</h2>
            <p style = "color: white;">即時更新的加密貨幣價格與市場數據，助您做出明智的決策。</p>
        </div>
    
        <div class="card_invent-container">
            <div class="card_invent">
                <div class="card_invent-inner">
                    <div class="card_invent-face card_invent-front">
                        <img src="{% static 'images/btc-1.png' %}" class="btc" alt="">
                        <h3>貨幣資料</h3>
                        <p>歷史數據</p>
                        <a href="{% url 'crypto_list' %}"><button class="arrow-btn">→</button></a>
                    </div>
                    <div class="card_invent-face card_invent-back">
                        <h2>市場統計</h2>
                        <p><strong>總市值 (USD):</strong> <span id="total_market_cap">載入中...</span></p>
                        <p><strong>24 小時交易量 (USD):</strong> <span id="total_24h_volume">載入中...</span></p>
                        <p><strong>市占率:</strong> <span id="btc_dominance">載入中...</span> | <span id="eth_dominance">載入中...</span> | <span id="other_dominance">載入中...</span></p>
                    </div>
                </div>
            </div>
    
            <div class="card_invent">
                <div class="card_invent-inner">
                    <div class="card_invent-face card_invent-front">
                        <img src="{% static 'images/news.png' %}" class="new" alt="">
                        <h2>外部資訊</h2>
                        <p>新聞資訊</p>
                        <a href="{% url 'news_home' %}"><button class="arrow-btn">→</button></a>
                    </div>
                    <div class="card_invent-face card_invent-back">
                        <h3>加密市場動態</h3>
                        <ul class = "ul">
                            <li>即時新聞</li>
                            <li>重要事件</li>
                            <li>市場趨勢變化</li>
                        </ul>
                    </div>
                </div>
            </div>
    
            <div class="card_invent">
                <div class="card_invent-inner">
                    <div class="card_invent-face card_invent-front">
                        <img src="{% static 'images/pointer.png' %}" class="point" alt="">
                        <h3>經濟指標</h3>
                        <p>投資工具</p>
                        <a href="{% url 'other_home' %}"><button class="arrow-btn">→</button></a>
                    </div>
                    <div class="card_invent-face card_invent-back">
                        <h3>關鍵經濟指標</h3>
                        <ul class = "ul">
                            <li>提升決策精準度</li>
                            <li>降低投資風險</li>
                            <li>全面市場分析</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    

    
    <button id="backToTop" class="back-to-top">▲ 回到頂部</button>

    <script src = "{% static 'js/home.js' %}"></script>

    
{% endblock %}

